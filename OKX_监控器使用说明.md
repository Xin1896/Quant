# OKX 挂单监控器使用说明

## 概述

本项目提供了两个OKX挂单监控工具，用于查看BTC和ETH的挂单情况，包括止盈和止损挂单的详细分析。

## 文件说明

### 1. `okx_order_monitor.py` - 基础监控器
- 查看当前挂单情况
- 分析挂单类型（止盈、止损、普通挂单）
- 显示挂单统计信息

### 2. `okx_advanced_monitor.py` - 高级监控器
- 实时监控挂单变化
- 详细分析止盈止损策略
- 市场情绪分析
- 持仓信息显示
- 潜在盈亏计算

## 环境配置

### 1. 安装依赖
```bash
pip install ccxt pandas python-dotenv numpy
```

### 2. 设置环境变量
创建 `.env` 文件并添加以下内容：
```env
OKX_API_KEY=你的API密钥
OKX_API_SECRET=你的API密钥
OKX_PASSPHRASE=你的API密码
```

### 3. 获取OKX API密钥
1. 登录OKX账户
2. 进入"设置" -> "API管理"
3. 创建新的API密钥
4. 确保勾选"交易"权限
5. 记录API Key、Secret Key和Passphrase

## 使用方法

### 基础监控器
```bash
python okx_order_monitor.py
```

**功能特点：**
- 一次性查看所有挂单
- 按类型分类显示（止盈、止损、普通）
- 显示挂单总金额和数量统计

### 高级监控器
```bash
python okx_advanced_monitor.py
```

**功能特点：**
- 实时监控（默认30秒更新一次）
- 详细策略分析（抄底、突破、获利了结等）
- 风险等级评估（低、中、高）
- 市场情绪分析
- 潜在盈亏计算
- 持仓信息显示

## 输出说明

### 挂单类型分类
- **止盈买入/卖出**: 价格高于当前价格5%以上的买入/卖出挂单
- **止损买入/卖出**: 价格低于当前价格5%以下的买入/卖出挂单
- **普通买入/卖出**: 价格在当前价格±5%范围内的挂单

### 策略分析
- **抄底策略**: 深度回调时的买入挂单
- **突破策略**: 突破阻力位的买入挂单
- **获利了结**: 高位止盈的卖出挂单
- **风险控制**: 止损卖出挂单
- **技术支撑/阻力**: 基于技术分析的挂单

### 风险等级
- 🟢 **低风险**: 市价附近或止盈挂单
- 🟡 **中风险**: 技术支撑/阻力位挂单
- 🔴 **高风险**: 深度回调或追高挂单

## 注意事项

1. **API权限**: 确保API密钥具有交易权限
2. **网络连接**: 需要稳定的网络连接
3. **频率限制**: OKX API有频率限制，程序已内置限流机制
4. **数据准确性**: 挂单数据实时更新，可能存在延迟
5. **风险提示**: 本工具仅用于分析，不构成投资建议

## 故障排除

### 常见错误
1. **API凭据错误**: 检查环境变量设置
2. **网络连接失败**: 检查网络连接和防火墙设置
3. **权限不足**: 确认API密钥具有交易权限
4. **频率限制**: 程序会自动处理，如频繁出现可增加更新间隔

### 调试模式
如需调试，可以修改代码中的错误处理部分，添加更详细的日志输出。

## 自定义配置

### 修改监控交易对
在代码中修改 `symbols` 参数：
```python
symbols=['BTC/USDT', 'ETH/USDT', 'SOL/USDT']  # 添加更多交易对
```

### 修改更新间隔
```python
monitor.monitor_orders_advanced(interval=60)  # 60秒更新一次
```

### 修改价格偏离阈值
在 `analyze_stop_loss_take_profit` 方法中修改判断阈值：
```python
if price_deviation < -5:  # 修改为-3%或其他值
```

## 技术支持

如有问题，请检查：
1. 环境变量是否正确设置
2. 网络连接是否正常
3. API密钥是否有效
4. 依赖包是否正确安装 