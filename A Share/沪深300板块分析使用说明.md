# 沪深300板块分析工具使用说明

## 功能概述

本工具用于分析沪深300指数成分股的板块分布，并按市值排序显示各个板块内的股票。工具提供三个版本：

1. **简化版** (`hs300_quick_analysis.py`) - 快速分析，无需市值数据
2. **完整版** (`hs300_sector_analysis_v2.py`) - 包含市值数据的详细分析
3. **基础版** (`hs300_sector_analysis.py`) - 基础功能版本

## 安装依赖

首先安装所需的Python包：

```bash
pip install -r requirements_hs300_analysis.txt
```

或者手动安装：

```bash
pip install akshare pandas numpy requests lxml beautifulsoup4
```

## 使用方法

### 1. 简化版（推荐新手使用）

```bash
python hs300_quick_analysis.py
```

**特点：**
- 运行速度快（约1-2分钟）
- 基于股票名称进行板块分类
- 生成简洁的HTML报告
- 包含权重信息

**输出：**
- 控制台显示板块统计信息
- 生成 `hs300_simple_analysis.html` 文件

### 2. 完整版（推荐使用）

```bash
python hs300_sector_analysis_v2.py
```

**特点：**
- 获取实时市值数据
- 更准确的板块分类
- 美观的HTML报告界面
- 包含详细的股票信息

**输出：**
- 控制台显示处理进度和统计信息
- 生成 `hs300_sector_analysis.html` 文件

### 3. 基础版

```bash
python hs300_sector_analysis.py
```

**特点：**
- 基础功能实现
- 适合学习和修改

## 板块分类说明

工具将股票分为以下主要板块：

| 板块 | 包含关键词 |
|------|------------|
| 金融 | 银行、保险、证券、信托、基金 |
| 房地产 | 地产、房地产、建筑、建材 |
| 科技 | 科技、软件、互联网、通信、电子、半导体、芯片 |
| 医药 | 医药、生物、医疗、器械 |
| 消费 | 消费、食品、饮料、家电、零售、旅游 |
| 汽车 | 汽车、新能源 |
| 能源 | 石油、煤炭、电力、燃气 |
| 原材料 | 钢铁、有色金属、化工 |
| 交通运输 | 航空、港口、物流、铁路、公路 |
| 工业 | 机械、装备、制造 |
| 农业 | 农业、养殖、种植 |
| 其他 | 未分类的股票 |

## HTML报告内容

生成的HTML报告包含：

1. **总体统计**
   - 总股票数量
   - 板块数量
   - 更新时间

2. **板块概览**
   - 各板块股票数量
   - 板块总权重
   - 平均权重

3. **详细股票列表**
   - 按板块分组显示
   - 股票代码和名称
   - 权重信息（完整版包含市值）

## 注意事项

1. **网络连接**：工具需要网络连接获取实时数据
2. **运行时间**：完整版可能需要5-10分钟，简化版约1-2分钟
3. **数据准确性**：板块分类基于股票名称关键词，可能存在分类不准确的情况
4. **API限制**：频繁请求可能受到API限制，工具已内置延时机制

## 故障排除

### 常见问题

1. **ImportError: No module named 'akshare'**
   ```bash
   pip install akshare
   ```

2. **网络连接错误**
   - 检查网络连接
   - 尝试使用VPN
   - 稍后重试

3. **数据获取失败**
   - 可能是API服务暂时不可用
   - 尝试使用简化版工具

4. **HTML文件无法打开**
   - 确保文件编码为UTF-8
   - 使用现代浏览器打开

### 调试模式

如需查看详细错误信息，可以修改代码中的异常处理部分，或添加更多调试输出。

## 自定义修改

### 修改板块分类

在 `classify_sector_simple()` 函数中修改 `sector_keywords` 字典：

```python
sector_keywords = {
    '金融': ['银行', '保险', '证券', '信托', '基金'],
    '科技': ['科技', '软件', '互联网', '通信', '电子'],
    # 添加更多板块...
}
```

### 修改HTML样式

在 `generate_simple_html()` 函数中修改CSS样式部分。

### 添加新的分析维度

可以修改代码添加更多分析维度，如：
- 按地区分类
- 按市值区间分类
- 按市盈率分类

## 数据来源

- **股票列表**：中证指数官网
- **权重数据**：akshare金融数据接口
- **市值数据**：东方财富网（完整版）

## 更新日志

- **v1.0** - 基础功能实现
- **v2.0** - 添加市值数据和改进UI
- **v2.1** - 优化板块分类和错误处理

## 技术支持

如遇到问题，请检查：
1. Python版本（建议3.7+）
2. 依赖包版本
3. 网络连接状态
4. 数据源服务状态 